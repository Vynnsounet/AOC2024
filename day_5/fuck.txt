i think that's a topo sort but eh, too lazy
